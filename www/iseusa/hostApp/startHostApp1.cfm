<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>(ISE) International Student Exchange - Foreign Exchange S</title>
<style type="text/css">
<!--
-->
</style>

<link href="../css/ISEstyle.css" rel="stylesheet" type="text/css" />
<style type="text/css">
<!--
#footer3 {
	clear: both;
	height: 40%;
	margin: 0;
	background-color: #000;
	padding-top: 0;
	padding-right: 0;
	padding-bottom: 0;
	padding-left: 0;
	bottom: -8px;
	display: block;
}
.tripsTours {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	width: 675px;
	margin-left: 35px;
	margin-top: 10px;
	padding: 0px;
	text-align: left;
}
a:link {
	color: #000;
	text-decoration: none;
}
a:visited {
	color: #000;
	text-decoration: none;
}
a:hover {
	color: #0B954E;
	text-decoration: none;
}
a {
	font-weight: bold;
}
a:active {
	text-decoration: none;
}
.Boxx {
	border: 2px dashed #000066;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 14px;
	font-weight: bold;
	color: #000066;
}
.Titles {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #000066;
	font-weight: bold;
	font-size: 14px;
}
.TitlesLG {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #000066;
	font-weight: bold;
	font-size: 20px;
}
.SubTitle {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #2E4F7A;
	font-weight: bold;
	font-size: 12px;
}
.SubTitleLG {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #2E4F7A;
	font-weight: bold;
	font-size: 16px;
}
.BottonText {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 9px;
	font-style: normal;
	line-height: normal;
	font-weight: lighter;
	font-variant: normal;
	color: #6B8098;
	background-image: url(file:///JW%20BACKUP/SMG/ISE/site/trips/images/botton.gif);
	background-repeat: no-repeat;
	background-position: center center;
	text-align: center;
	vertical-align: middle;
}
.RegularText {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10px;
	color:#000000;
	font-style: normal;
	font-weight: normal;
}
.style1 {color: #FFFFFF}
.style2 {font-size: 12px}
.style4 {font-size: 12}
.style5 {color: #FFFFFF; font-weight: bold; }
.style6 {
	color: #FFFFFF;
	font-weight: bold;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10px;
	}
.image-right {
border:solid 1px;
margin-right: 0px;
margin-left: 15px;
}
.image-left {
border:solid 1px;
margin-right: 15px;
margin-left: 0px;
}
.whtMiddletours2{
	background-image: url(../images/whtBoxMiddle.png);
	background-repeat: repeat-y;
	margin: 0px;
	text-align: justify;
	padding-top: 20px;
	padding-right: 0px;
	padding-bottom: 0px;
	padding-left: 0px;
}
.bBackground {
	background-color: #C5DCEA;
	border: thin solid #000;
	text-align: center;
}
<!----New CSS---->
#footer3 {
	clear: both;
	height: 40%;
	margin: 0;
	background-color: #000;
	padding-top: 0;
	padding-right: 0;
	padding-bottom: 0;
	padding-left: 0;
	bottom: -8px;
	display: block;
}
.tripsTours {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	width: 675px;
	margin-left: 35px;
	margin-top: 10px;
	padding: 0px;
	text-align: left;
}
a:link {
	color: #000;
	text-decoration: none;
}
a:visited {
	color: #000;
	text-decoration: none;
}
a:hover {
	color: #0B954E;
	text-decoration: none;
}
a {
	font-weight: bold;
}
a:active {
	text-decoration: none;
}
.Boxx {
	border: 2px dashed #000066;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 14px;
	font-weight: bold;
	color: #000066;
}
.Titles {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #000066;
	font-weight: bold;
	font-size: 14px;
}
.TitlesLG {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #000066;
	font-weight: bold;
	font-size: 20px;
}
.SubTitle {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #2E4F7A;
	font-weight: bold;
	font-size: 12px;
}
.SubTitleLG {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	color: #2E4F7A;
	font-weight: bold;
	font-size: 16px;
}
.BottonText {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 9px;
	font-style: normal;
	line-height: normal;
	font-weight: lighter;
	font-variant: normal;
	color: #6B8098;
	background-image: url(file:///JW%20BACKUP/SMG/ISE/site/trips/images/botton.gif);
	background-repeat: no-repeat;
	background-position: center center;
	text-align: center;
	vertical-align: middle;
}
.RegularText {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10px;
	color:#000000;
	font-style: normal;
	font-weight: normal;
}
.style1 {color: #FFFFFF}
.style2 {font-size: 12px}
.style4 {font-size: 12}
.style5 {color: #FFFFFF; font-weight: bold; }
.style6 {
	color: #FFFFFF;
	font-weight: bold;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10px;
	}
.image-right {
border:solid 1px;
margin-right: 0px;
margin-left: 15px;
}
.image-left {
border:solid 1px;
margin-right: 15px;
margin-left: 0px;
}
.whtMiddletours2{
	background-image: url(../images/whtBoxMiddle.png);
	background-repeat: repeat-y;
	margin: 0px;
	text-align: justify;
	padding-top: 20px;
	padding-right: 0px;
	padding-bottom: 0px;
	padding-left: 0px;
}
.bBackground {
	background-color: #C5DCEA;
	border: thin solid #000;
	text-align: center;
}
.border{border:solid 1px;}
<!----- ----->
H1 { text-transform: capitalize }
.p_uppercase { 
text-transform: capitalize;
padding-top: 2px;
margin: 0px;
}
.redtext {
	color: #FF0000;
}
-->
</style>
</head>

<body class="oneColFixCtr">
<!----Create Temp Login---->

 		<cfset CLIENT.company_submitting = "www.iseusa.com">
        <cfset APPLICATION.company_short = "ISE">
        <cfset CLIENT.app_menu_comp = 5>
        <cfset CLIENT.exits_url = "www.iseusa.com">
        <cfset application.support_email = "support@iseusa.com">
        <cfset client.usertype = 14>
        <Cfset application.address_lookup = 0>




<!--- need to use url.hostid since there's a client.hostid but phase client.hostid out. --->
<cfparam name="url.hostid" default="">
<cfif url.hostid EQ "">
	<cfset new = true>
<cfelse>
	<cfif not isNumeric(url.hostid)>
        a numeric hostid is required.
        <cfabort>
	</cfif>
	<cfset new = false>
</cfif>

<cfset field_list = 'familylastname,address,address2,city,state,zip,phone,email,fatherlastname,fatherfirstname,fathermiddlename,fatherdob,fatherssn,fatherworktype,father_cell,motherlastname,motherfirstname,mothermiddlename,motherdob,motherssn,motherworktype,mother_cell,regionid'>

<!--- the key for encrypting and decrypting the ssn. --->
<cfset ssn_key = 'BB9ztVL+zrYqeWEq1UALSj4pkc4vZLyR'>

<!--- Process Form Submission --->
<cfif isDefined("form.submitted")>
    
	<cfif form.lookup_success NEQ "1">
		<cfset errorMsg = 'Please lookup the address.'>
	<cfelseif trim(form.familylastname) EQ "">
		<cfset errorMsg = "Please enter the Family Name.">
	<cfelseif application.address_lookup NEQ 2 and trim(form.address) EQ ''>
		<cfset errorMsg = "Please enter the Address.">
	<cfelseif application.address_lookup NEQ 2 and trim(form.city) EQ ''>
		<cfset errorMsg = "Please enter the City.">
	<cfelseif application.address_lookup NEQ 2 and trim(form.state) EQ ''>
		<cfset errorMsg = "Please select the State.">
	<cfelseif application.address_lookup NEQ 2 and not isValid("zipcode", trim(form.zip))>
		<cfset errorMsg = "Please enter a valid Zip.">        
	<cfelseif trim(form.phone) EQ '' and trim(form.father_cell) EQ '' and trim(form.mother_cell) EQ ''>
		<cfset errorMsg = "Please enter one of the Phone fields.">
	<cfelseif trim(form.phone) NEQ '' and not isValid("telephone", trim(form.phone))>
		<cfset errorMsg = "Please enter a valid Phone.">
	<cfelseif trim(form.email) NEQ '' and not isValid("email", trim(form.email))>
		<cfset errorMsg = "Please enter a valid Email.">
	<cfelseif trim(form.fatherdob) NEQ '' and not isValid("date", trim(form.fatherdob))>
		<cfset errorMsg = "Please enter a valid Father's Date of Birth.">
	<cfelseif isDefined("form.fatherssn") and trim(form.fatherssn) NEQ '' and not isValid("social_security_number", trim(form.fatherssn))>
		<cfset errorMsg = "Please enter a valid Father's SSN.">
	<cfelseif trim(form.father_cell) NEQ '' and not isValid("telephone", trim(form.father_cell))>
		<cfset errorMsg = "Please enter a valid Father's Cell Phone.">
	<cfelseif trim(form.motherdob) NEQ '' and not isValid("date", trim(form.motherdob))>
		<cfset errorMsg = "Please enter a valid Mother's Date of Birth.">
	<cfelseif isDefined("form.motherssn") and trim(form.motherssn) NEQ '' and not isValid("social_security_number", trim(form.motherssn))>
		<cfset errorMsg = "Please enter a valid Mother's SSN.">
	<cfelseif trim(form.mother_cell) NEQ '' and not isValid("telephone", trim(form.mother_cell))>
		<cfset errorMsg = "Please enter a valid Mother's Cell Phone.">
	<!----<cfelseif new and form.regionid EQ ''>
		<cfset errorMsg = "Please select the Region.">---->
	<cfelse>
    	<!--- encrypt the SSN. --->
		<cfif isDefined("form.fatherssn") and trim(form.fatherssn) NEQ ''>
            <cfset form.fatherssn = encrypt("#trim(form.fatherssn)#", "#ssn_key#", "desede", "hex")>
        </cfif>
		<cfif isDefined("form.motherssn") and trim(form.motherssn) NEQ ''>
            <cfset form.motherssn = encrypt("#trim(form.motherssn)#", "#ssn_key#", "desede", "hex")>
        </cfif>
        <!--- set the birth year field from the birth date field. --->
        <cfif trim(form.fatherdob) NEQ ''>
        	<cfset fatherbirth = year(trim(form.fatherdob))>
        <cfelse>
        	<cfset fatherbirth = 0>
        </cfif>
        <cfif trim(form.motherdob) NEQ ''>
        	<cfset motherbirth = year(trim(form.motherdob))>
        <cfelse>
        	<cfset motherbirth = 0>
        </cfif>
		<cfif new>
        	<cflock timeout="30">
                <cfquery datasource="mysql">
                    INSERT INTO smg_hosts (familylastname, fatherlastname, fatherfirstname, fathermiddlename, fatherbirth, fatherdob, fatherssn, fatherworktype, father_cell,
                        motherfirstname, motherlastname, mothermiddlename, motherbirth, motherdob, motherssn, motherworktype, mother_cell,
                        address, address2, city, state, zip, phone, email, companyid, <!----regionid, arearepid,----> date_record_entered)
                    VALUES (
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.familylastname#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherlastname#" null="#yesNoFormat(trim(form.fatherlastname) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherfirstname#" null="#yesNoFormat(trim(form.fatherfirstname) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fathermiddlename#" null="#yesNoFormat(trim(form.fathermiddlename) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_integer" value="#fatherbirth#">,
                    <cfqueryparam cfsqltype="cf_sql_date" value="#form.fatherdob#" null="#yesNoFormat(trim(form.fatherdob) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherssn#" null="#yesNoFormat(trim(form.fatherssn) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherworktype#" null="#yesNoFormat(trim(form.fatherworktype) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.father_cell#" null="#yesNoFormat(trim(form.father_cell) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherfirstname#" null="#yesNoFormat(trim(form.motherfirstname) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherlastname#" null="#yesNoFormat(trim(form.motherlastname) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.mothermiddlename#" null="#yesNoFormat(trim(form.mothermiddlename) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_integer" value="#motherbirth#">,
                    <cfqueryparam cfsqltype="cf_sql_date" value="#form.motherdob#" null="#yesNoFormat(trim(form.motherdob) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherssn#" null="#yesNoFormat(trim(form.motherssn) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherworktype#" null="#yesNoFormat(trim(form.motherworktype) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.mother_cell#" null="#yesNoFormat(trim(form.mother_cell) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.address#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.address2#" null="#yesNoFormat(trim(form.address2) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.city#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.state#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.zip#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.phone#" null="#yesNoFormat(trim(form.phone) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.email#" null="#yesNoFormat(trim(form.email) EQ '')#">,
                    <cfqueryparam cfsqltype="cf_sql_integer" value="#client.companyid#">,
                   <!----<cfqueryparam cfsqltype="cf_sql_integer" value="#form.regionid#">,
                    <cfqueryparam cfsqltype="cf_sql_integer" value="#client.userid#">,---->
                    #now()#
                    )  
                </cfquery>
                <cfquery name="get_id" datasource="mysql">
                    SELECT MAX(hostid) AS hostid

                    FROM smg_hosts
                </cfquery>
            </cflock>
            <!--- the client variable should be phased out after host_fam_mem_form, etc. are modified to use url.hostid --->
			<cfset client.hostid = get_id.hostid>
            <cflocation url="familyMembers.cfm" addtoken="No">
		<!--- edit --->
	<!--- edit --->
		<cfelse>
			<cfquery datasource="#application.dsn#">
				UPDATE smg_hosts SET
                familylastname = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.familylastname#">,
                fatherlastname = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherlastname#" null="#yesNoFormat(trim(form.fatherlastname) EQ '')#">,
                fatherfirstname = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherfirstname#" null="#yesNoFormat(trim(form.fatherfirstname) EQ '')#">,
                fathermiddlename = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fathermiddlename#" null="#yesNoFormat(trim(form.fathermiddlename) EQ '')#">,
                fatherbirth = <cfqueryparam cfsqltype="cf_sql_integer" value="#fatherbirth#">,
                fatherdob = <cfqueryparam cfsqltype="cf_sql_date" value="#form.fatherdob#" null="#yesNoFormat(trim(form.fatherdob) EQ '')#">,
                <cfif isDefined("form.fatherssn")>
                	fatherssn = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherssn#" null="#yesNoFormat(trim(form.fatherssn) EQ '')#">,
                </cfif>
                fatherworktype = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.fatherworktype#" null="#yesNoFormat(trim(form.fatherworktype) EQ '')#">,
                father_cell = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.father_cell#" null="#yesNoFormat(trim(form.father_cell) EQ '')#">,
                motherfirstname = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherfirstname#" null="#yesNoFormat(trim(form.motherfirstname) EQ '')#">,
                motherlastname = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherlastname#" null="#yesNoFormat(trim(form.motherlastname) EQ '')#">,
                mothermiddlename = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.mothermiddlename#" null="#yesNoFormat(trim(form.mothermiddlename) EQ '')#">,
                motherbirth = <cfqueryparam cfsqltype="cf_sql_integer" value="#motherbirth#">,
                motherdob = <cfqueryparam cfsqltype="cf_sql_date" value="#form.motherdob#" null="#yesNoFormat(trim(form.motherdob) EQ '')#">,
                <cfif isDefined("form.motherssn")>
                	motherssn = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherssn#" null="#yesNoFormat(trim(form.motherssn) EQ '')#">,
                </cfif>
                motherworktype = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.motherworktype#" null="#yesNoFormat(trim(form.motherworktype) EQ '')#">,
                mother_cell = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.mother_cell#" null="#yesNoFormat(trim(form.mother_cell) EQ '')#">,
                address = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.address#">,
                address2 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.address2#" null="#yesNoFormat(trim(form.address2) EQ '')#">,
                city = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.city#">,
                state = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.state#">,
                zip = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.zip#">,
                phone = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.phone#" null="#yesNoFormat(trim(form.phone) EQ '')#">,
                email = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.email#" null="#yesNoFormat(trim(form.email) EQ '')#">
				WHERE hostid = <cfqueryparam cfsqltype="cf_sql_integer" value="#url.hostid#">
			</cfquery>
            <cflocation url="index.cfm?curdoc=host_fam_info&hostid=#url.hostid#" addtoken="No">
		</cfif>
		
		
	</cfif>

<!--- add --->
<cfelseif new>

	<cfloop list="#field_list#" index="counter">
    	<cfset "form.#counter#" = "">
	</cfloop>

	<!--- lookup_success must be 0 to require lookup on add. --->
	<cfset form.lookup_success = 0>
    <cfset form.lookup_address = ''>
    
    <!--- allow SSN --->
	<cfset form.allow_fatherssn = 0>
	<cfset form.allow_motherssn = 0>
    
<!--- edit --->
<cfelseif not new>

	<cfquery name="get_record" datasource="mysql">
		SELECT *
		FROM smg_hosts
		WHERE hostid = <cfqueryparam cfsqltype="cf_sql_integer" value="#url.hostid#">
	</cfquery>
	<cfloop list="#field_list#" index="counter">
    	<cfset "form.#counter#" = evaluate("get_record.#counter#")>
	</cfloop>
    
    <!--- the default values in the database for these used to be "na", so remove any. --->
    <cfif form.father_cell EQ 'na'>
    	<cfset form.father_cell = ''>
    </cfif>
    <cfif form.mother_cell EQ 'na'>
    	<cfset form.mother_cell = ''>
    </cfif>

	<!--- lookup_success may be set to 1 to not require lookup on edit. --->
	<cfset form.lookup_success = 0>
    <cfset form.lookup_address = '#get_record.address##chr(13)##chr(10)##get_record.city# #get_record.state# #get_record.zip#'>

    <cfquery name="user_compliance" datasource="mysql">
        SELECT compliance
        FROM smg_users
        WHERE userid = <cfqueryparam value="#client.userid#" cfsqltype="cf_sql_integer">
    </cfquery>
	<cfset form.allow_fatherssn = 1>
	<cfset form.allow_motherssn = 1>
	<!--- SSN: allow if null, or if not null and the user has access. --->
	<cfif get_record.fatherssn EQ '' or user_compliance.compliance EQ 1>
		<cfset form.allow_fatherssn = 1>
        <cfif get_record.fatherssn NEQ ''>
			<cfset form.fatherssn = decrypt(get_record.fatherssn, "#ssn_key#", "desede", "hex")>
        </cfif>
	</cfif>
	<cfif get_record.motherssn EQ '' or user_compliance.compliance EQ 1>
		<cfset form.allow_motherssn = 1>
        <cfif get_record.motherssn NEQ ''>
			<cfset form.motherssn = decrypt(get_record.motherssn, "#ssn_key#", "desede", "hex")>
        </cfif>
	</cfif>

</cfif>

<cfif isDefined("errorMsg")>
	<script language="JavaScript">
        alert('<cfoutput>#errorMsg#</cfoutput>');
    </script>
</cfif>

<!--- address lookup turned on. --->
<cfif application.address_lookup>
	<cfinclude template="includes/address_lookup_#application.address_lookup#.cfm">
<!--- address lookup turned off. --->
<cfelse>
	<!--- set to true so lookup is not required. --->
	<cfset form.lookup_success = 1>
</cfif>

<script type="text/javascript">
function checkForm() {
	<cfif application.address_lookup NEQ 2>
		if (document.my_form.state.value.length == 0) {alert("Please select the State."); return false; }
	</cfif>
	if (document.my_form.lookup_success.value != 1) {alert("Please lookup the address."); return false; }
	if (document.my_form.phone.value.length == 0 && document.my_form.father_cell.value.length == 0 && document.my_form.mother_cell.value.length == 0) {alert("Please enter one of the Phone fields."); return false; }
	<cfif new>
		if (document.my_form.regionid.value.length == 0) {alert("Please select the Region."); return false; }
	</cfif>
	return true;
}
function lastname(form) {
	form.fatherlastname.value = form.familylastname.value;
	form.motherlastname.value = form.familylastname.value;
}
</script>



<cfquery name="preHostInfo" datasource="mysql">
SELECT shl.firstname, shl.lastname, shl.address, shl.address2, shl.city, shl.stateID, shl.zipCode, shl.email, shl.phone, smg_states.state
FROM smg_host_lead shl
LEFT JOIN smg_states on smg_states.id = shl.stateID
where email = '#client.email#'
</cfquery>
<cfoutput>
<div id="topBar">
<cfinclude template="../topBarLinks.cfm">
<div id="logoBox"><a href="/"><img src="../images/ISElogo.png" width="214" height="165" alt="ISE logo" border="0" /></a></div>
<!-- end topBar --></div>
<div id="container">
<div class="spacer2"></div>
<div class="title"><!-- end title --></div>
<div class="tabsBar">
  <cfinclude template="../tabsBar.cfm">
  <!-- end tabsBar --></div>
<div id="mainContent">
<div id="subPages">
      <div class="whtTop"></div>
  <div class="whtMiddletours2">
        <div class="tripsTours">
       
  
          <h1 class="enter">#lcase(prehostInfo.lastname)# Family Application</h1>
          <p>Completing the host family application will take between 15 and 30 minutes.  You do not have to complete it all at once, feel free to come back and complete it. </p>

<table align="Center" bgcolor="##33FFFF"width=90%>
	<Tr>
    	<td></td>
	</td>
    <tr>
    	<Td>Name & Contact Info</Td><Td>Family Members</Td><Td>Community Info</Td><td>Interestes</td><td>Misc Info</td><td>Complete!</td>
    </tr>
</table>
<br />

<!----
onSubmit="return checkForm();"
---->
<form method="post" action="startHostApp.cfm?&hostid=#url.hostid#" name="my_form"  onsubmit="return validate(this)">
<input type="hidden" name="submitted" value="1">
<input type="hidden" name="allow_fatherssn" value="#form.allow_fatherssn#">
<input type="hidden" name="allow_motherssn" value="#form.allow_motherssn#">
<!--- this gets set to 1 by the javascript lookup function on success. --->
<input type="hidden" name="lookup_success" value="#form.lookup_success#">


<div align="center">
  <span class="redtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * Required fields &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + One phone field is required</span>
</div>
  <div id="wrapper">
  <h2>Address, Phone & Email</h2>
  <table width=100% cellspacing=0 cellpadding=2 class="border">
    <tr>
        <td class="label"><h3>Family Name<span class="redtext">*</span></h3> </td>
        <td colspan=3>
            <!--- automatically fill in last names on new form only. --->
            <cfif new>
                <cfset blurValue = 'javascript:lastname(this.form);'>
            <cfelse>
                <cfset blurValue = ''>
            </cfif>
            <input type="text" name="familylastname" value="#form.familylastname#" size="20" maxlength="150" onBlur="#blurValue#">
        </td>
    </tr>

<!--- address lookup - auto version. --->
<cfif application.address_lookup EQ 2>
    <tr bgcolor="##deeaf3">
        <td class="label">Lookup Address <span class="redtext">*</span></td>
        <td colspan=3>
            Enter at least the street address and zip code and click "Lookup".<br />
            Address, City, State, and Zip will be automatically filled in.<br />
            Address line 2 should be manually entered if needed.<br />
            <cftextarea name="lookup_address" rows="2" cols="30" value="#form.lookup_address#" /><br />
            <input type="button" value="Lookup" onClick="showLocation();" />
        </td>
    </tr>
    <tr>
        <td class="label"><h3>Address</h3></td>
        <td colspan=3><input type="text" name="address" value="#form.address#" size="40" maxlength="150" readonly="readonly"></td>
    </tr>
    <tr bgcolor="##deeaf3">
        <td></td>
        <td colspan=3><input type="text" name="address2" value="#form.address2#" size="40" maxlength="150"></td>
    </tr>
    <tr>			 
        <td class="label"><h3>City</h3></td>
        <td colspan=3><input type="text" name="city" value="#form.city#" size="20" maxlength="150" readonly="readonly"></td>
    </tr>
    <tr bgcolor="##deeaf3">
        <td class="label"><h3>State</h3></td>
        <td><input type="text" name="state" value="#form.state#" size="2" maxlength="2" readonly="readonly"></td>
        <td class="zip"><h3>Zip</h3></td>
        <td><input type="text" name="zip" value="#form.zip#" size="5" maxlength="5" readonly="readonly"></td>
    </tr>
<cfelse>
    <tr bgcolor="##deeaf3">
        <td class="label"><h3>Address <span class="redtext">*</span></h3></td>
        <td colspan=3>
        	<input type="text" name="address" value="#form.address#" size="40" maxlength="150" required="yes" validate="noblanks" message="Please enter the Address.">
            <font size="1">NO PO BOXES</font>
        </td>
    </tr>
    <tr bgcolor="##deeaf3">
        <td></td>
        <td colspan=3><input type="text" name="address2" value="#form.address2#" size="40" maxlength="150"></td>
    </tr>
    <tr>			 
        <td class="label"><h3>City <span class="redtext">*</span></h3></td>
        <td colspan=3><input type="text" name="city" value="#form.city#" size="20" maxlength="150" required="yes" validate="noblanks" message="Please enter the City."></td>
    </tr>
    <tr bgcolor="##deeaf3">
        <td class="label"><h3>State <span class="redtext">*</span></h3></td>
        <td>
            <cfquery name="get_states" datasource="mysql">
                SELECT state, statename
                FROM smg_states
                ORDER BY id
            </cfquery>
			<select NAME="state" query="get_states" value="state" display="statename" selected="#form.state#" queryPosition="below">
				<option></option>
			</select>
        </td>
        <td class="zip"><h3>Zip<span class="redtext">*</span></h3> </td>
        <td><input type="text" name="zip" value="#form.zip#" size="5" maxlength="5" required="yes" validate="zipcode" message="Please enter a valid Zip."></td>
    </tr>
	<!--- address lookup - simple version. --->
    <cfif application.address_lookup EQ 1>
        <tr>
            <td class="label"><h3>Lookup Address<span class="redtext">*</span></h3> </td>
            <td colspan=3><font size="1">
	            Enter Address, City, State, and Zip and click "Lookup".<br />
                Verify the address displayed below, and make any corrections on the form if necessary.<br />
                Address line 2 will not be included below.<br />
                If you have trouble submitting an address, <a href="mailto:<cfoutput>#application.support_email#</cfoutput>?subject=Address Lookup">send it to us</a>.<br />
                <input type="button" value="Lookup" onClick="showLocation();" /><br />
		        <textarea name="lookup_address" readonly="readonly" rows="2" cols="30">Lookup address will be displayed here.</textarea>
            </font></td>
        </tr>
    </cfif>
</cfif>

    <tr >
        <td ><h3>Phone <span class="redtext">+</span></h3></td>
        <td colspan=3><input type="text" name="phone" value="#form.phone#" size="14" maxlength="14" mask="(999) 999-9999" validate="telephone" message="Please enter a valid Phone."></td>
    </tr>
    <tr bgcolor="##deeaf3">
        <td ><h3>Email</h3></td>
        <td colspan=3><input type="text" name="email" value="#form.email#" size="30" maxlength="200" validate="email" message="Please enter a valid Email."></td>
    </tr>
</table>
<br />
  <h2>Father's Information</h2>
  <table width=100% cellspacing=0 cellpadding=2 class="border">
    <tr>
    	<td class="label"><h3>Last Name</h3></td>
        <td><input type="text" name="fatherlastname" value="#form.fatherlastname#" size="20" maxlength="150"></td>
    </tr>
    <tr bgcolor="##deeaf3">
    	<td class="label"><h3>First Name</h3></td>
        <td><input type="text" name="fatherfirstname" value="#form.fatherfirstname#" size="20" maxlength="150"></td>
    </tr>
    <tr>
    	<td class="label"><h3>Middle Name</h3></td>
        <td><input type="text" name="fathermiddlename" value="#form.fathermiddlename#" size="20" maxlength="150"></td>
    </tr>
    <tr bgcolor="##deeaf3">
    	<td class="label"><h3>Date of Birth</h3></td>
        <td><input type="text" name="fatherdob" value="#dateFormat(form.fatherdob, 'mm/dd/yyyy')#" size="10" maxlength="10" mask="99/99/9999" validate="date" message="Please enter a valid Father's Date of Birth."> mm/dd/yyyy</td>
    </tr>

    <tr >
    	<td class="label"><h3>Occupation</h3></td>
        <td><input type="text" name="fatherworktype" value="#form.fatherworktype#" size="50" maxlength="200"></td>
    </tr>
    <tr bgcolor="##deeaf3">
        <td class="label"><h3>Cell Phone <span class="redtext">+</span></h3></td>
        <td colspan=3><input type="text" name="father_cell" value="#form.father_cell#" size="14" maxlength="14" mask="(999) 999-9999" validate="telephone" message="Please enter a valid Father's Cell Phone."></td>
    </tr>
        <cfif form.allow_fatherssn eq 1>
        <tr>
        	<td class="label"><h3>SSN</h3></td>
            <td><input type="text" name="fatherssn" value="#form.fatherssn#" size="11" maxlength="11" mask="999-99-9999" validate="social_security_number" message="Please enter a valid Father's SSN."> <em>We use this durring the background check.</em></td>
        </tr>	
    </cfif>
</table>
<br />
  <h2>Mother's Information</h2>
  <table width=100% cellspacing=0 cellpadding=2 class="border">
    <tr>
    	<td class="label"><h3>Last Name</h3></td>
        <td><input type="text" name="motherlastname" value="#form.motherlastname#" size="20" maxlength="150"></td>
    </tr>
    <tr  bgcolor="##deeaf3">
    	<td class="label"><h3>First Name</h3></td>
        <td><input type="text" name="motherfirstname" value="#form.motherfirstname#" size="20" maxlength="150"></td>
    </tr>
    <tr>
    	<td class="label"><h3>Middle Name</h3></td>
        <td><input type="text" name="mothermiddlename" value="#form.mothermiddlename#" size="20" maxlength="150"></td>
    </tr>			
    <tr  bgcolor="##deeaf3">
    	<td class="label"><h3>Date of Birth</h3></td>
        <td><input type="text" name="motherdob" value="#dateFormat(form.motherdob, 'mm/dd/yyyy')#" size="10" maxlength="10" mask="99/99/9999" validate="date" message="Please enter a valid Mother's Date of Birth."> mm/dd/yyyy</td>
    </tr>

    <tr>
    	<td class="label"><h3>Occupation</h3></td>
        <td><input type="text" name="motherworktype" value="#form.motherworktype#" size="50" maxlength="200"></td>
    </tr>
    <tr   bgcolor="##deeaf3">
        <td class="label"><h3>Cell Phone <span class="redtext">+</span></h3></td>
        <td colspan=3><input type="text" name="mother_cell" value="#form.mother_cell#" size="14" maxlength="14" mask="(999) 999-9999" validate="telephone" message="Please enter a valid Mother's Cell Phone."></td>
    </tr>
        <cfif form.allow_motherssn eq 1>
        <tr>
        	<td class="label"><h3>SSN</h3></td>
            <td><input type="text" name="motherssn" value="#form.motherssn#" size="11" maxlength="11" mask="999-99-9999" validate="social_security_number" message="Please enter a valid Mother's SSN."> <em>We use this durring the background check.</em></td>
        </tr>		
    </cfif>
</table> 		
</div>





<table border=0 cellpadding=4 cellspacing=0 width=100% class="section">
    <tr>
       
        <td align="right"><input name="Submit" type="image" src="../images/buttons/Next.png" border=0></td>
    </tr>
</table>
    
</form>








        <div id="main" class="clearfix"></div>
      <!-- endtripTours --></div>
      <div id="main" class="clearfix"></div>
      <!-- end whtMiddle --></div>
      <div class="whtBottom"></div>
      <!-- end subpages --></div>
    <!-- end mainContent --></div>
<!-- end container --></div>
<div id="main" class="clearfix"></div>
<div id="footer">
  <div class="clear"></div>
<cfinclude template="../bottomLinks.cfm">
<!-- end footer --></div>
</cfoutput>
</body>
</html>
